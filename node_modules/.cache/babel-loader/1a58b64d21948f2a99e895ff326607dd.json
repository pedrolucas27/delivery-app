{"ast":null,"code":"var _jsxFileName = \"/home/pedro/Documentos/projects/master-pizza/delivery-app-v2/src/pages/ListProducts/index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { useAlert } from 'react-alert';\nimport API from \"../../server/api.js\";\nimport { isLoggedIn } from \"../../server/auth.js\";\nimport { getIdCompany } from \"../../helpers.js\";\nimport Navbar from \"../../components/Navbar\";\nimport Header from \"../../components/Header\";\nimport Footer from \"../../components/Footer\";\nimport CardProduct from \"../../components/CardProduct\";\nimport ShoppingCartMobile from \"../../components/ShoppingCart\";\nimport Loading from \"../../components/Loading\";\nimport ModalAddCart from \"../../components/ModalAddCart\";\nimport MessageIsEmpty from \"../../components/MessageIsEmpty\";\nimport \"../../index.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ListProducts = () => {\n  _s();\n\n  const ID_COMPANY = getIdCompany();\n  const idCategory = localStorage.getItem(\"@masterpizza-delivery-app/id-category\");\n  const [openCart, setOpenCart] = useState(false);\n  const [loadingFlag, setLoadingFlag] = useState(false);\n  const [showModal, setShowModal] = useState(false);\n  const [products, setProducts] = useState([]);\n  const [productCart, setProductCart] = useState(\"\");\n  const [logged, setLogged] = useState(false);\n  const alert = useAlert();\n  useEffect(() => {\n    var _localStorage$getItem;\n\n    let length_array = (_localStorage$getItem = localStorage.getItem(\"@masterpizza-delivery-app/key-flavor\")) === null || _localStorage$getItem === void 0 ? void 0 : _localStorage$getItem.split(\",\").length;\n    setLoadingFlag(true);\n    verifyAuth();\n\n    if (length_array > 1) {\n      getProductsByMisto();\n    } else {\n      getProductsByCategoryAndFlavor();\n    }\n\n    setLoadingFlag(false);\n  }, []);\n\n  const verifyAuth = () => {\n    isLoggedIn().then(response => {\n      setLogged(response);\n    }).catch(error => {\n      setLogged(false);\n    });\n  };\n\n  const getProductsByCategoryAndFlavor = async () => {\n    const idFlavor = localStorage.getItem(\"@masterpizza-delivery-app/key-flavor\");\n    API.get(\"product/others/\" + idCategory + \"/\" + idFlavor + \"/\" + ID_COMPANY).then(response => {\n      let array = [];\n      response.data.forEach(product => {\n        array.push({\n          id: product.id_product,\n          name: product.name_product,\n          description: product.description,\n          image: product.image ? `http://192.168.0.110:8080/${product.image}` : null,\n          price: product.price,\n          size: product.size_product + \" (\" + product.unit + \" - \" + product.abreviation + \")\",\n          is_product_mister: false\n        });\n      });\n      setProducts(array);\n    }).catch(error => {\n      alert.error('Erro ao tentar listar produtos!');\n    });\n  };\n\n  const getProductsByMisto = async () => {\n    let array = [];\n    let flavors = localStorage.getItem(\"@masterpizza-delivery-app/key-flavor\").split(\",\");\n    API.get(\"product/others/\" + idCategory + \"/\" + ID_COMPANY).then(response => {\n      response.data.forEach(product => {\n        if (product.fk_id_flavor === flavors[0] || product.fk_id_flavor === flavors[1]) {\n          array.push(product);\n        }\n      });\n      filterProductsMistoPerSize(array);\n    }).catch(error => {\n      alert.error('Erro ao tentar listar produtos!');\n    });\n  };\n\n  const filterProductsMistoPerSize = products => {\n    let sizesSimilar = [];\n    let productsMisto = [];\n    let flavors = localStorage.getItem(\"@masterpizza-delivery-app/key-flavor\").split(\",\");\n    const productsFlavorOne = products.filter(item => item.fk_id_flavor === flavors[0]);\n    const productsFlavorTwo = products.filter(item => item.fk_id_flavor === flavors[1]);\n\n    for (let i = 0; i < productsFlavorOne.length; i++) {\n      for (let j = 0; j < productsFlavorTwo.length; j++) {\n        if (productsFlavorOne[i].fk_id_unit === productsFlavorTwo[j].fk_id_unit) {\n          sizesSimilar.push(productsFlavorOne[i].fk_id_unit);\n          productsMisto.push({\n            id: productsFlavorOne[i].id_product,\n            id_2: productsFlavorTwo[j].id_product,\n            name: \"Pizza: 1/2 \" + productsFlavorOne[i].name_flavor + \" + 1/2 \" + productsFlavorTwo[j].name_flavor,\n            description: \"Produto misto.\",\n            price: productsFlavorOne[i].price + productsFlavorTwo[j].price,\n            size: productsFlavorOne[i].size_product + \" (\" + productsFlavorOne[i].unit + \" - \" + productsFlavorOne[i].abreviation + \")\",\n            is_product_mister: true\n          });\n        }\n      }\n    }\n\n    setProducts(productsMisto);\n  };\n\n  const changeProduct = (idProduct, idProduct2) => {\n    setLoadingFlag(true);\n    let product = {};\n\n    if (idProduct2) {\n      product = products.filter(item => item.id === idProduct && item.id_2 === idProduct2)[0];\n    } else {\n      product = products.filter(item => item.id === idProduct)[0];\n    }\n\n    setProductCart(product);\n    setTimeout(() => {\n      setLoadingFlag(false);\n      setShowModal(true);\n    }, 1000);\n  };\n\n  const addCartProduct = async (quantity, is_additional) => {\n    let product_cart = {};\n\n    if (is_additional) {\n      product_cart = {\n        id_product_fk: null,\n        id_product_fk2: null,\n        quantity_item: quantity,\n        price_item_order: quantity * productCart.price,\n        observation: null,\n        id_additional_fk: productCart.id\n      };\n    } else {\n      product_cart = {\n        id_product_fk: productCart.id,\n        id_product_fk2: productCart.is_product_mister ? productCart.id_2 : null,\n        quantity_item: quantity,\n        price_item_order: quantity * productCart.price,\n        observation: productCart.is_product_mister ? productCart.name : null,\n        id_additional_fk: null\n      };\n    }\n\n    await insertProductInCart(product_cart);\n  };\n\n  const insertProductInCart = async product => {\n    verifyAuth();\n    setLoadingFlag(true);\n\n    try {\n      if (logged) {\n        const idClient = localStorage.getItem('@masterpizza-delivery-app/id_client');\n        const responseProductCart = await API.post(\"cart_product\", {\n          product: product,\n          id_client_fk: idClient,\n          is_pdv: false,\n          id_company: ID_COMPANY\n        });\n        setLoadingFlag(false);\n\n        if (responseProductCart.status === 200) {\n          alert.success('Adicionado no carrinho! Siga em frente.');\n          setShowModal(false);\n          window.location.href = \"/menu\"; //getAdditionalsByCategory(idCategoryOrder);\n        } else {\n          alert.error('Error ao tentar adicionar no carrinho! Tente novamente.');\n          setShowModal(false);\n        }\n      } else {\n        setLoadingFlag(false);\n        alert.error('Faça o login antes de adicionar produto no carrinho!');\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 1000);\n      }\n    } catch (error) {\n      setLoadingFlag(false);\n      alert.error('Erro ao tentar inserir produto no carrinho.');\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: !loadingFlag ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Navbar, {\n        current: \"menu\",\n        clickCartMobile: () => setOpenCart(!openCart)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 8\n      }, this), /*#__PURE__*/_jsxDEV(Header, {\n        title: 'Cardápio',\n        listProducts: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 8\n      }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"px-4 py-6 sm:px-0\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rounded-lg h-96\",\n              children: products.length !== 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid gap-4 sm:grid-cols-2 md:grid-cols-3\",\n                children: products.map(product => {\n                  return /*#__PURE__*/_jsxDEV(CardProduct, {\n                    name: product.name,\n                    image: product.image,\n                    price: product.price,\n                    description: product.description,\n                    showModal: product.is_product_misto ? () => changeProduct(product.id, product.id_2) : () => changeProduct(product.id, null)\n                  }, product.id, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 204,\n                    columnNumber: 18\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 200,\n                columnNumber: 20\n              }, this) : /*#__PURE__*/_jsxDEV(MessageIsEmpty, {\n                title: \"Nenhum produto foi encontrado com a categoria e sabor (es) escolhidos!\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 222,\n                columnNumber: 20\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 12\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 8\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 8\n      }, this), /*#__PURE__*/_jsxDEV(ShoppingCartMobile, {\n        open: openCart,\n        close: () => setOpenCart(false),\n        onLoading: flag => setLoadingFlag(flag),\n        idClient: logged ? localStorage.getItem('@masterpizza-delivery-app/id_client') : null,\n        idCompany: logged ? ID_COMPANY : null,\n        logged: logged\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 8\n      }, this), /*#__PURE__*/_jsxDEV(ModalAddCart, {\n        show: showModal,\n        product: productCart,\n        closeModal: () => setShowModal(false),\n        addCartProduct: quantity => addCartProduct(quantity, false)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 8\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 7\n    }, this) : /*#__PURE__*/_jsxDEV(Loading, {\n      time: 5000\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 6\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 188,\n    columnNumber: 3\n  }, this);\n};\n\n_s(ListProducts, \"JON5FNI5zmaOjaRm+BnFaZqKOLI=\", false, function () {\n  return [useAlert];\n});\n\n_c = ListProducts;\nexport default ListProducts;\n\nvar _c;\n\n$RefreshReg$(_c, \"ListProducts\");","map":{"version":3,"sources":["/home/pedro/Documentos/projects/master-pizza/delivery-app-v2/src/pages/ListProducts/index.js"],"names":["React","useState","useEffect","useAlert","API","isLoggedIn","getIdCompany","Navbar","Header","Footer","CardProduct","ShoppingCartMobile","Loading","ModalAddCart","MessageIsEmpty","ListProducts","ID_COMPANY","idCategory","localStorage","getItem","openCart","setOpenCart","loadingFlag","setLoadingFlag","showModal","setShowModal","products","setProducts","productCart","setProductCart","logged","setLogged","alert","length_array","split","length","verifyAuth","getProductsByMisto","getProductsByCategoryAndFlavor","then","response","catch","error","idFlavor","get","array","data","forEach","product","push","id","id_product","name","name_product","description","image","price","size","size_product","unit","abreviation","is_product_mister","flavors","fk_id_flavor","filterProductsMistoPerSize","sizesSimilar","productsMisto","productsFlavorOne","filter","item","productsFlavorTwo","i","j","fk_id_unit","id_2","name_flavor","changeProduct","idProduct","idProduct2","setTimeout","addCartProduct","quantity","is_additional","product_cart","id_product_fk","id_product_fk2","quantity_item","price_item_order","observation","id_additional_fk","insertProductInCart","idClient","responseProductCart","post","id_client_fk","is_pdv","id_company","status","success","window","location","href","map","is_product_misto","flag"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useAlert } from 'react-alert';\nimport API from \"../../server/api.js\"\nimport { isLoggedIn } from \"../../server/auth.js\";\nimport { getIdCompany } from \"../../helpers.js\";\nimport Navbar from \"../../components/Navbar\";\nimport Header from \"../../components/Header\";\nimport Footer from \"../../components/Footer\";\nimport CardProduct from \"../../components/CardProduct\";\nimport ShoppingCartMobile from \"../../components/ShoppingCart\";\nimport Loading from \"../../components/Loading\";\nimport ModalAddCart from \"../../components/ModalAddCart\";\nimport MessageIsEmpty from \"../../components/MessageIsEmpty\";\nimport \"../../index.css\";\n\nconst ListProducts = () => {\n\tconst ID_COMPANY = getIdCompany();\n\tconst idCategory = localStorage.getItem(\"@masterpizza-delivery-app/id-category\");\n\n\tconst [openCart, setOpenCart] = useState(false);\n\tconst [loadingFlag, setLoadingFlag] = useState(false);\n\tconst [showModal, setShowModal] = useState(false);\n\tconst [products, setProducts] = useState([]);\n\tconst [productCart, setProductCart] = useState(\"\");\n\tconst [logged, setLogged] = useState(false);\n\tconst alert = useAlert();\n\n\tuseEffect(() => {\n\t\tlet length_array = localStorage.getItem(\"@masterpizza-delivery-app/key-flavor\")?.split(\",\").length;\n\t\tsetLoadingFlag(true);\n\t\tverifyAuth();\n\t\tif(length_array > 1){\n\t\t\tgetProductsByMisto();\n\t\t}else{\n\t\t\tgetProductsByCategoryAndFlavor();\n\t\t}\n\t\tsetLoadingFlag(false);\n\t}, []);\n\n\n\tconst verifyAuth = () => {\n\t\tisLoggedIn().then((response) => {\n\t\t\tsetLogged(response);\n\t\t}).catch((error) => {\n\t\t\tsetLogged(false);\n\t\t});\n\t}\n\n\tconst getProductsByCategoryAndFlavor = async () => {\n\t\tconst idFlavor = localStorage.getItem(\"@masterpizza-delivery-app/key-flavor\");\n\t\tAPI.get(\"product/others/\" + idCategory + \"/\" + idFlavor + \"/\" + ID_COMPANY).then((response) => {\n\t\t\tlet array = [];\n\t\t\tresponse.data.forEach((product) => {\n\t\t\t\tarray.push({\n\t\t\t\t\tid: product.id_product,\n\t\t\t\t\tname: product.name_product,\n\t\t\t\t\tdescription: product.description,\n\t\t\t\t\timage: product.image ? `http://192.168.0.110:8080/${product.image}`:null,\n\t\t\t\t\tprice: product.price,\n\t\t\t\t\tsize: product.size_product + \" (\" + product.unit + \" - \" + product.abreviation + \")\",\n\t\t\t\t\tis_product_mister: false\n\t\t\t\t})\n\t\t\t})\n\t\t\tsetProducts(array);\n\t\t}).catch((error) => {\n\t\t\talert.error('Erro ao tentar listar produtos!');\n\t\t});\n\t}\n\n\tconst getProductsByMisto = async () => {\t\n\t\tlet array = [];\n\t\tlet flavors = localStorage.getItem(\"@masterpizza-delivery-app/key-flavor\").split(\",\");\n\t\tAPI.get(\"product/others/\" + idCategory + \"/\" + ID_COMPANY).then((response) => {\n\t\t\tresponse.data.forEach((product) => {\n\t\t\t\tif ((product.fk_id_flavor === flavors[0]) || (product.fk_id_flavor === flavors[1])) {\n\t\t\t\t\tarray.push(product);\n\t\t\t\t}\n\t\t\t})\n\t\t\tfilterProductsMistoPerSize(array);\n\t\t}).catch((error) => {\n\t\t\talert.error('Erro ao tentar listar produtos!');\n\t\t});\t\n\t}\n\n\tconst filterProductsMistoPerSize = (products) => {\n\t\tlet sizesSimilar = [];\n\t\tlet productsMisto = [];\n\t\tlet flavors = localStorage.getItem(\"@masterpizza-delivery-app/key-flavor\").split(\",\");\n\t\tconst productsFlavorOne = products.filter((item) => item.fk_id_flavor === flavors[0]);\n\t\tconst productsFlavorTwo = products.filter((item) => item.fk_id_flavor === flavors[1]);\n\n\t\tfor (let i = 0; i < productsFlavorOne.length; i++) {\n\t\t\tfor (let j = 0; j < productsFlavorTwo.length; j++) {\n\t\t\t\tif (productsFlavorOne[i].fk_id_unit === productsFlavorTwo[j].fk_id_unit) {\n\t\t\t\t\tsizesSimilar.push(productsFlavorOne[i].fk_id_unit);\n\t\t\t\t\tproductsMisto.push({\n\t\t\t\t\t\tid: productsFlavorOne[i].id_product,\n\t\t\t\t\t\tid_2: productsFlavorTwo[j].id_product,\n\t\t\t\t\t\tname: \"Pizza: 1/2 \" + productsFlavorOne[i].name_flavor + \" + 1/2 \" + productsFlavorTwo[j].name_flavor,\n\t\t\t\t\t\tdescription: \"Produto misto.\",\n\t\t\t\t\t\tprice: productsFlavorOne[i].price + productsFlavorTwo[j].price,\n\t\t\t\t\t\tsize: productsFlavorOne[i].size_product + \" (\" + productsFlavorOne[i].unit + \" - \" + productsFlavorOne[i].abreviation + \")\",\n\t\t\t\t\t\tis_product_mister: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsetProducts(productsMisto);\n\t}\n\n\tconst changeProduct = (idProduct, idProduct2) => {\n\t\tsetLoadingFlag(true);\n\t\tlet product = {};\n\t\tif(idProduct2){\n\t\t\tproduct = products.filter((item) => item.id === idProduct && item.id_2 === idProduct2)[0];\n\t\t} else {\n\t\t\tproduct = products.filter((item) => item.id === idProduct)[0];\n\t\t}\n\t\tsetProductCart(product);\n\t\tsetTimeout(() => {\n\t\t\tsetLoadingFlag(false);\n\t\t\tsetShowModal(true);\n\t\t}, 1000);\n\t}\n\n\tconst addCartProduct = async (quantity, is_additional) => {\n\t\tlet product_cart = {};\n\t\tif(is_additional){\n\t\t\tproduct_cart = {\n\t\t\t\tid_product_fk: null, \n\t\t\t\tid_product_fk2: null, \n\t\t\t\tquantity_item: quantity, \n\t\t\t\tprice_item_order: quantity * productCart.price, \n\t\t\t\tobservation: null, \n\t\t\t\tid_additional_fk: productCart.id\n\t\t\t}\n\t\t}else{\n\t\t\tproduct_cart = {\n\t\t\t\tid_product_fk: productCart.id, \n\t\t\t\tid_product_fk2: productCart.is_product_mister ? productCart.id_2:null, \n\t\t\t\tquantity_item: quantity, \n\t\t\t\tprice_item_order: quantity * productCart.price, \n\t\t\t\tobservation: productCart.is_product_mister ? productCart.name:null, \n\t\t\t\tid_additional_fk: null\n\t\t\t}\n\t\t}\n\t\tawait insertProductInCart(product_cart);\n\t}\n\n\tconst insertProductInCart = async (product) => {\n\t\tverifyAuth();\n\t\tsetLoadingFlag(true);\n\t\ttry{\n\t\t\tif(logged){\n\t\t\t\tconst idClient = localStorage.getItem('@masterpizza-delivery-app/id_client');\n\t\t\t\tconst responseProductCart = await API.post(\"cart_product\",\n\t\t\t\t\t{\n\t\t\t\t\t\tproduct: product,\n\t\t\t\t\t\tid_client_fk: idClient,\n\t\t\t\t\t\tis_pdv: false,\n\t\t\t\t\t\tid_company: ID_COMPANY\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tsetLoadingFlag(false);\n\t\t\t\tif(responseProductCart.status === 200){\n\t\t\t\t\talert.success('Adicionado no carrinho! Siga em frente.');\n\t\t\t\t\tsetShowModal(false);\n\t\t\t\t\twindow.location.href = \"/menu\";\n\t\t\t\t\t//getAdditionalsByCategory(idCategoryOrder);\n\t\t\t\t}else{\n\t\t\t\t\talert.error('Error ao tentar adicionar no carrinho! Tente novamente.');\n\t\t\t\t\tsetShowModal(false);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tsetLoadingFlag(false);\n\t\t\t\talert.error('Faça o login antes de adicionar produto no carrinho!');\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\twindow.location.href = \"/login\";\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t} catch(error){\n\t\t\tsetLoadingFlag(false);\n\t\t\talert.error('Erro ao tentar inserir produto no carrinho.');\n\t\t}\t\n\t}\n\n\treturn(\n\t\t<div>\n\t\t\t{\n\t\t\t\t!loadingFlag ? (\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Navbar current={\"menu\"} clickCartMobile={() => setOpenCart(!openCart)} />\n\t\t\t\t\t\t\t<Header title={'Cardápio'} listProducts={true} />\n\t\t\t\t\t\t\t<main>\n\t\t\t\t\t\t    \t<div className=\"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8\">\n\t\t\t\t\t\t      \t\t<div className=\"px-4 py-6 sm:px-0\">\n\t\t\t\t\t\t        \t\t<div className=\"rounded-lg h-96\">\n\t\t\t\t\t\t        \t\t\t{\n\t\t\t\t\t\t        \t\t\t\tproducts.length !== 0 ? (\n\t\t\t\t\t\t        \t\t\t\t\t<div className=\"grid gap-4 sm:grid-cols-2 md:grid-cols-3\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tproducts.map((product) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CardProduct\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={product.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname={product.name}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\timage={product.image}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprice={product.price}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdescription={product.description}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowModal={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tproduct.is_product_misto ?\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t() => changeProduct(product.id, product.id_2)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t() => changeProduct(product.id, null)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t        \t\t\t\t):(\n\t\t\t\t\t\t        \t\t\t\t\t<MessageIsEmpty \n\t\t\t\t\t\t        \t\t\t\t\t\ttitle=\"Nenhum produto foi encontrado com a categoria e sabor (es) escolhidos!\"\n\t\t\t\t\t\t        \t\t\t\t\t/>\n\t\t\t\t\t\t        \t\t\t\t)\n\t\t\t\t\t\t        \t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t       \t\t\t</div>\n\t\t\t\t\t\t     \t\t</div>\n\t\t\t\t\t\t    \t</div>\n\t\t\t\t\t\t\t</main>\n\t\t\t\t\t\t\t<Footer />\n\t\t\t\t\t\t\t<ShoppingCartMobile \n\t\t\t\t\t\t\t\topen={openCart}\n\t\t\t\t\t\t\t\tclose={() => setOpenCart(false)}\n\t\t\t\t\t\t\t\tonLoading={(flag) => setLoadingFlag(flag)}\n\t\t\t\t\t\t\t\tidClient={logged ? localStorage.getItem('@masterpizza-delivery-app/id_client'):null}\n\t\t\t\t\t\t\t\tidCompany={logged ? ID_COMPANY:null}\n\t\t\t\t\t\t\t\tlogged={logged}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<ModalAddCart \n\t\t\t\t\t\t\t\tshow={showModal}\n\t\t\t\t\t\t\t\tproduct={productCart}\n\t\t\t\t\t\t\t\tcloseModal={() => setShowModal(false)}\n\t\t\t\t\t\t\t\taddCartProduct={(quantity) => addCartProduct(quantity, false)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t):(\n\t\t\t\t\t<Loading time={5000}/>\n\t\t\t\t)\n\t\t\t}\n\t\t</div>\n\t);\n}\nexport default ListProducts;\n"]},"metadata":{},"sourceType":"module"}